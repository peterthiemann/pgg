; Generated by CF Analysis Development Version, June 1, 1995
; (cf:control 'poly 'if-split '!const-split '!verbose '!times '(cons-limit 8) '!check '!inline '!simplify '!clean)
(define (main)
(let ((*numTest* 100000))
  (let ((node (lambda (v l r) (vector v l r))))
    (let ((tree-foreach
           (lambda (t f)
             (letrec ((foreach
                       (lambda (t)
                         (if (null? t)
                             ((lambda () ()))
                             (if (and (vector? t)
                                      (equal? (vector-length t) 3))
                                 ((lambda (v l r)
                                    (begin (f v) (foreach l) (foreach r)))
                                  (vector-ref t 0)
                                  (vector-ref t 1)
                                  (vector-ref t 2))
                                 ((lambda (G10)
                                    (match:error
                                      G10
                                      '(match
                                         t
                                         (() ())
                                         (#(v l r)
                                           (begin (f v)
                                                  (foreach l)
                                                  (foreach r))))))
                                  t))))))
               (foreach t)))))
      (let ((tree-forall?
             (lambda (t f)
               (letrec ((forall?
                         (lambda (t)
                           (if (null? t)
                               ((lambda () #t))
                               (if (and (vector? t)
                                        (equal? (vector-length t) 3))
                                   ((lambda (v l r)
                                      (and (f v) (forall? l) (forall? r)))
                                    (vector-ref t 0)
                                    (vector-ref t 1)
                                    (vector-ref t 2))
                                   ((lambda (G16)
                                      (match:error
                                        G16
                                        '(match
                                           t
                                           (() #t)
                                           (#(v l r)
                                             (and (f v)
                                                  (forall? l)
                                                  (forall? r))))))
                                    t))))))
                 (forall? t)))))
        (let ((tree-exists?
               (lambda (t f)
                 (not (tree-forall? t (lambda (x) (not (f x))))))))
          (let ((tree-fold
                 (lambda (t b f)
                   (letrec ((fold
                             (lambda (t)
                               (if (null? t)
                                   ((lambda () b))
                                   (if (and (vector? t)
                                            (equal? (vector-length t) 3))
                                       ((lambda (v l r)
                                          (f v (fold l) (fold r)))
                                        (vector-ref t 0)
                                        (vector-ref t 1)
                                        (vector-ref t 2))
                                       ((lambda (G22)
                                          (match:error
                                            G22
                                            '(match
                                               t
                                               (() b)
                                               (#(v l r)
                                                 (f v
                                                    (fold l)
                                                    (fold r))))))
                                        t))))))
                     (fold t)))))
            (let ((tree-size
                   (lambda (t) (tree-fold t 0 (lambda (_ l r) (+ 1 l r))))))
              (let ((tree->list
                     (lambda (t)
                       (letrec ((x->list
                                 (lambda (t accum)
                                   (if (null? t)
                                       ((lambda () accum))
                                       (if (and (vector? t)
                                                (equal?
                                                  (vector-length t)
                                                  3))
                                           ((lambda (v l r)
                                              (x->list
                                                l
                                                (cons v (x->list r accum))))
                                            (vector-ref t 0)
                                            (vector-ref t 1)
                                            (vector-ref t 2))
                                           ((lambda (G28)
                                              (match:error
                                                G28
                                                '(match
                                                   t
                                                   (() accum)
                                                   (#(v l r)
                                                     (x->list
                                                       l
                                                       (cons v
                                                             (x->list
                                                               r
                                                               accum)))))))
                                            t))))))
                         (x->list t ())))))
                (let ((splay
                       (lambda (t k)
                         (letrec ((splay
                                   (lambda (t)
                                     (if (and (vector? t)
                                              (equal? (vector-length t) 3))
                                         ((lambda (v l r)
                                            (if (= k v)
                                                t
                                                (if (< k v)
                                                    (if (null? l)
                                                        ((lambda () t))
                                                        (if (and (vector?
                                                                   l)
                                                                 (equal?
                                                                   (vector-length
                                                                     l)
                                                                   3))
                                                            ((lambda (v1
                                                                      l1
                                                                      r1)
                                                               (if (= k v1)
                                                                   (node v1
                                                                         l1
                                                                         (node v
                                                                               r1
                                                                               r))
                                                                   (if (< k
                                                                          v1)
                                                                       (if (null?
                                                                             l1)
                                                                           (node v1
                                                                                 ()
                                                                                 (node v
                                                                                       r1
                                                                                       r))
                                                                           (let ((G43
                                                                                  (splay
                                                                                    l1)))
                                                                             (if (and (vector?
                                                                                        G43)
                                                                                      (equal?
                                                                                        (vector-length
                                                                                          G43)
                                                                                        3))
                                                                                 ((lambda (v2
                                                                                           l2
                                                                                           r2)
                                                                                    (node v2
                                                                                          l2
                                                                                          (node v1
                                                                                                r2
                                                                                                (node v
                                                                                                      r1
                                                                                                      r))))
                                                                                  (vector-ref
                                                                                    G43
                                                                                    0)
                                                                                  (vector-ref
                                                                                    G43
                                                                                    1)
                                                                                  (vector-ref
                                                                                    G43
                                                                                    2))
                                                                                 ((lambda (G46)
                                                                                    (match:error
                                                                                      G46
                                                                                      '(match
                                                                                         (splay
                                                                                           l1)
                                                                                         (#(v2
                                                                                             l2
                                                                                             r2)
                                                                                           (node v2
                                                                                                 l2
                                                                                                 (node v1
                                                                                                       r2
                                                                                                       (node v
                                                                                                             r1
                                                                                                             r)))))))
                                                                                  G43))))
                                                                       (if (null?
                                                                             r1)
                                                                           (node v1
                                                                                 l1
                                                                                 (node v
                                                                                       ()
                                                                                       r))
                                                                           (let ((G49
                                                                                  (splay
                                                                                    r1)))
                                                                             (if (and (vector?
                                                                                        G49)
                                                                                      (equal?
                                                                                        (vector-length
                                                                                          G49)
                                                                                        3))
                                                                                 ((lambda (v2
                                                                                           l2
                                                                                           r2)
                                                                                    (node v2
                                                                                          (node v1
                                                                                                l1
                                                                                                l2)
                                                                                          (node v
                                                                                                r2
                                                                                                r)))
                                                                                  (vector-ref
                                                                                    G49
                                                                                    0)
                                                                                  (vector-ref
                                                                                    G49
                                                                                    1)
                                                                                  (vector-ref
                                                                                    G49
                                                                                    2))
                                                                                 ((lambda (G52)
                                                                                    (match:error
                                                                                      G52
                                                                                      '(match
                                                                                         (splay
                                                                                           r1)
                                                                                         (#(v2
                                                                                             l2
                                                                                             r2)
                                                                                           (node v2
                                                                                                 (node v1
                                                                                                       l1
                                                                                                       l2)
                                                                                                 (node v
                                                                                                       r2
                                                                                                       r))))))
                                                                                  G49)))))))
                                                             (vector-ref
                                                               l
                                                               0)
                                                             (vector-ref
                                                               l
                                                               1)
                                                             (vector-ref
                                                               l
                                                               2))
                                                            ((lambda (G39)
                                                               (match:error
                                                                 G39
                                                                 '(match
                                                                    l
                                                                    (() t)
                                                                    (#(v1
                                                                        l1
                                                                        r1)
                                                                      (cond
                                                                        ((= k
                                                                            v1)
                                                                         (node v1
                                                                               l1
                                                                               (node v
                                                                                     r1
                                                                                     r)))
                                                                        ((< k
                                                                            v1)
                                                                         (if (null?
                                                                               l1)
                                                                             (node v1
                                                                                   ()
                                                                                   (node v
                                                                                         r1
                                                                                         r))
                                                                             (match-let
                                                                               ((#(v2
                                                                                    l2
                                                                                    r2)
                                                                                  (splay
                                                                                    l1)))
                                                                               (node v2
                                                                                     l2
                                                                                     (node v1
                                                                                           r2
                                                                                           (node v
                                                                                                 r1
                                                                                                 r))))))
                                                                        ((null?
                                                                           r1)
                                                                         (node v1
                                                                               l1
                                                                               (node v
                                                                                     ()
                                                                                     r)))
                                                                        (else
                                                                         (match-let
                                                                           ((#(v2
                                                                                l2
                                                                                r2)
                                                                              (splay
                                                                                r1)))
                                                                           (node v2
                                                                                 (node v1
                                                                                       l1
                                                                                       l2)
                                                                                 (node v
                                                                                       r2
                                                                                       r)))))))))
                                                             l)))
                                                    (if (null? r)
                                                        t
                                                        (if (and (vector?
                                                                   r)
                                                                 (equal?
                                                                   (vector-length
                                                                     r)
                                                                   3))
                                                            ((lambda (v1
                                                                      l1
                                                                      r1)
                                                               (if (= k v1)
                                                                   (node v1
                                                                         (node v
                                                                               l
                                                                               l1)
                                                                         r1)
                                                                   (if (< k
                                                                          v1)
                                                                       (if (null?
                                                                             l1)
                                                                           (node v1
                                                                                 (node v
                                                                                       l
                                                                                       ())
                                                                                 r1)
                                                                           (let ((G60
                                                                                  (splay
                                                                                    l1)))
                                                                             (if (and (vector?
                                                                                        G60)
                                                                                      (equal?
                                                                                        (vector-length
                                                                                          G60)
                                                                                        3))
                                                                                 ((lambda (v2
                                                                                           l2
                                                                                           r2)
                                                                                    (node v2
                                                                                          (node v
                                                                                                l
                                                                                                l2)
                                                                                          (node v1
                                                                                                r2
                                                                                                r1)))
                                                                                  (vector-ref
                                                                                    G60
                                                                                    0)
                                                                                  (vector-ref
                                                                                    G60
                                                                                    1)
                                                                                  (vector-ref
                                                                                    G60
                                                                                    2))
                                                                                 ((lambda (G63)
                                                                                    (match:error
                                                                                      G63
                                                                                      '(match
                                                                                         (splay
                                                                                           l1)
                                                                                         (#(v2
                                                                                             l2
                                                                                             r2)
                                                                                           (node v2
                                                                                                 (node v
                                                                                                       l
                                                                                                       l2)
                                                                                                 (node v1
                                                                                                       r2
                                                                                                       r1))))))
                                                                                  G60))))
                                                                       (if (null?
                                                                             r1)
                                                                           (node v1
                                                                                 (node v
                                                                                       l
                                                                                       l1)
                                                                                 ())
                                                                           (let ((G66
                                                                                  (splay
                                                                                    r1)))
                                                                             (if (and (vector?
                                                                                        G66)
                                                                                      (equal?
                                                                                        (vector-length
                                                                                          G66)
                                                                                        3))
                                                                                 ((lambda (v2
                                                                                           l2
                                                                                           r2)
                                                                                    (node v2
                                                                                          (node v1
                                                                                                (node v
                                                                                                      l
                                                                                                      l1)
                                                                                                l2)
                                                                                          r2))
                                                                                  (vector-ref
                                                                                    G66
                                                                                    0)
                                                                                  (vector-ref
                                                                                    G66
                                                                                    1)
                                                                                  (vector-ref
                                                                                    G66
                                                                                    2))
                                                                                 ((lambda (G69)
                                                                                    (match:error
                                                                                      G69
                                                                                      '(match
                                                                                         (splay
                                                                                           r1)
                                                                                         (#(v2
                                                                                             l2
                                                                                             r2)
                                                                                           (node v2
                                                                                                 (node v1
                                                                                                       (node v
                                                                                                             l
                                                                                                             l1)
                                                                                                       l2)
                                                                                                 r2)))))
                                                                                  G66)))))))
                                                             (vector-ref
                                                               r
                                                               0)
                                                             (vector-ref
                                                               r
                                                               1)
                                                             (vector-ref
                                                               r
                                                               2))
                                                            ((lambda (G57)
                                                               (match:error
                                                                 G57
                                                                 '(match
                                                                    r
                                                                    (#(v1
                                                                        l1
                                                                        r1)
                                                                      (cond
                                                                        ((= k
                                                                            v1)
                                                                         (node v1
                                                                               (node v
                                                                                     l
                                                                                     l1)
                                                                               r1))
                                                                        ((< k
                                                                            v1)
                                                                         (if (null?
                                                                               l1)
                                                                             (node v1
                                                                                   (node v
                                                                                         l
                                                                                         ())
                                                                                   r1)
                                                                             (match-let
                                                                               ((#(v2
                                                                                    l2
                                                                                    r2)
                                                                                  (splay
                                                                                    l1)))
                                                                               (node v2
                                                                                     (node v
                                                                                           l
                                                                                           l2)
                                                                                     (node v1
                                                                                           r2
                                                                                           r1)))))
                                                                        ((null?
                                                                           r1)
                                                                         (node v1
                                                                               (node v
                                                                                     l
                                                                                     l1)
                                                                               ()))
                                                                        (else
                                                                         (match-let
                                                                           ((#(v2
                                                                                l2
                                                                                r2)
                                                                              (splay
                                                                                r1)))
                                                                           (node v2
                                                                                 (node v1
                                                                                       (node v
                                                                                             l
                                                                                             l1)
                                                                                       l2)
                                                                                 r2))))))))
                                                             r))))))
                                          (vector-ref t 0)
                                          (vector-ref t 1)
                                          (vector-ref t 2))
                                         ((lambda (G34)
                                            (match:error
                                              G34
                                              '(match
                                                 t
                                                 (#(v l r)
                                                   (cond
                                                     ((= k v) t)
                                                     ((< k v)
                                                      (match
                                                        l
                                                        (() t)
                                                        (#(v1 l1 r1)
                                                          (cond
                                                            ((= k v1)
                                                             (node v1
                                                                   l1
                                                                   (node v
                                                                         r1
                                                                         r)))
                                                            ((< k v1)
                                                             (if (null? l1)
                                                                 (node v1
                                                                       ()
                                                                       (node v
                                                                             r1
                                                                             r))
                                                                 (match-let
                                                                   ((#(v2
                                                                        l2
                                                                        r2)
                                                                      (splay
                                                                        l1)))
                                                                   (node v2
                                                                         l2
                                                                         (node v1
                                                                               r2
                                                                               (node v
                                                                                     r1
                                                                                     r))))))
                                                            ((null? r1)
                                                             (node v1
                                                                   l1
                                                                   (node v
                                                                         ()
                                                                         r)))
                                                            (else
                                                             (match-let
                                                               ((#(v2
                                                                    l2
                                                                    r2)
                                                                  (splay
                                                                    r1)))
                                                               (node v2
                                                                     (node v1
                                                                           l1
                                                                           l2)
                                                                     (node v
                                                                           r2
                                                                           r))))))))
                                                     ((null? r) t)
                                                     (else
                                                      (match-let
                                                        ((#(v1 l1 r1) r))
                                                        (cond
                                                          ((= k v1)
                                                           (node v1
                                                                 (node v
                                                                       l
                                                                       l1)
                                                                 r1))
                                                          ((< k v1)
                                                           (if (null? l1)
                                                               (node v1
                                                                     (node v
                                                                           l
                                                                           ())
                                                                     r1)
                                                               (match-let
                                                                 ((#(v2
                                                                      l2
                                                                      r2)
                                                                    (splay
                                                                      l1)))
                                                                 (node v2
                                                                       (node v
                                                                             l
                                                                             l2)
                                                                       (node v1
                                                                             r2
                                                                             r1)))))
                                                          ((null? r1)
                                                           (node v1
                                                                 (node v
                                                                       l
                                                                       l1)
                                                                 ()))
                                                          (else
                                                           (match-let
                                                             ((#(v2 l2 r2)
                                                                (splay
                                                                  r1)))
                                                             (node v2
                                                                   (node v1
                                                                         (node v
                                                                               l
                                                                               l1)
                                                                         l2)
                                                                   r2)))))))))))
                                          t)))))
                           (splay t)))))
                  (let ((splay-to-max
                         (letrec ((splay
                                   (lambda (G72)
                                     (let ((G74
                                            (lambda (G75)
                                              (match:error
                                                G75
                                                '(match
                                                   G72
                                                   (#(v l ())
                                                     (vector v l))
                                                   (#(v l #(v1 l1 ()))
                                                     (vector
                                                       v1
                                                       (node v l l1)))
                                                   (#(v l #(v1 l1 r1))
                                                     (match-let
                                                       ((#(v2 l2)
                                                          (splay r1)))
                                                       (vector
                                                         v2
                                                         (node v1
                                                               (node v
                                                                     l
                                                                     l1)
                                                               l2)))))))))
                                       (if (and (vector? G72)
                                                (equal?
                                                  (vector-length G72)
                                                  3))
                                           (if (null? (vector-ref G72 2))
                                               ((lambda (v l) (vector v l))
                                                (vector-ref G72 0)
                                                (vector-ref G72 1))
                                               (if (and (vector?
                                                          (vector-ref
                                                            G72
                                                            2))
                                                        (equal?
                                                          (vector-length
                                                            (vector-ref
                                                              G72
                                                              2))
                                                          3))
                                                   (if (null?
                                                         (vector-ref
                                                           (vector-ref
                                                             G72
                                                             2)
                                                           2))
                                                       ((lambda (v l v1 l1)
                                                          (vector
                                                            v1
                                                            (node v l l1)))
                                                        (vector-ref G72 0)
                                                        (vector-ref G72 1)
                                                        (vector-ref
                                                          (vector-ref
                                                            G72
                                                            2)
                                                          0)
                                                        (vector-ref
                                                          (vector-ref
                                                            G72
                                                            2)
                                                          1))
                                                       ((lambda (v
                                                                 l
                                                                 v1
                                                                 l1
                                                                 r1)
                                                          (let ((G80
                                                                 (splay
                                                                   r1)))
                                                            (if (and (vector?
                                                                       G80)
                                                                     (equal?
                                                                       (vector-length
                                                                         G80)
                                                                       2))
                                                                ((lambda (v2
                                                                          l2)
                                                                   (vector
                                                                     v2
                                                                     (node v1
                                                                           (node v
                                                                                 l
                                                                                 l1)
                                                                           l2)))
                                                                 (vector-ref
                                                                   G80
                                                                   0)
                                                                 (vector-ref
                                                                   G80
                                                                   1))
                                                                ((lambda (G83)
                                                                   (match:error
                                                                     G83
                                                                     '(match
                                                                        (splay
                                                                          r1)
                                                                        (#(v2
                                                                            l2)
                                                                          (vector
                                                                            v2
                                                                            (node v1
                                                                                  (node v
                                                                                        l
                                                                                        l1)
                                                                                  l2))))))
                                                                 G80))))
                                                        (vector-ref G72 0)
                                                        (vector-ref G72 1)
                                                        (vector-ref
                                                          (vector-ref
                                                            G72
                                                            2)
                                                          0)
                                                        (vector-ref
                                                          (vector-ref
                                                            G72
                                                            2)
                                                          1)
                                                        (vector-ref
                                                          (vector-ref
                                                            G72
                                                            2)
                                                          2)))
                                                   (G74 G72)))
                                           (G74 G72))))))
                           splay)))
                    (let ((splay-to-min
                           (letrec ((splay
                                     (lambda (G86)
                                       (let ((G88
                                              (lambda (G89)
                                                (match:error
                                                  G89
                                                  '(match
                                                     G86
                                                     (#(v () r)
                                                       (vector v r))
                                                     (#(v #(v1 () r1) r)
                                                       (vector
                                                         v1
                                                         (node v r1 r)))
                                                     (#(v #(v1 l1 r1) r)
                                                       (match-let
                                                         ((#(v2 r2)
                                                            (splay l1)))
                                                         (vector
                                                           v2
                                                           (node v1
                                                                 r2
                                                                 (node v
                                                                       r1
                                                                       r))))))))))
                                         (if (and (vector? G86)
                                                  (equal?
                                                    (vector-length G86)
                                                    3))
                                             (if (null? (vector-ref G86 1))
                                                 ((lambda (v r)
                                                    (vector v r))
                                                  (vector-ref G86 0)
                                                  (vector-ref G86 2))
                                                 (if (and (vector?
                                                            (vector-ref
                                                              G86
                                                              1))
                                                          (equal?
                                                            (vector-length
                                                              (vector-ref
                                                                G86
                                                                1))
                                                            3))
                                                     (if (null?
                                                           (vector-ref
                                                             (vector-ref
                                                               G86
                                                               1)
                                                             1))
                                                         ((lambda (v
                                                                   v1
                                                                   r1
                                                                   r)
                                                            (vector
                                                              v1
                                                              (node v
                                                                    r1
                                                                    r)))
                                                          (vector-ref
                                                            G86
                                                            0)
                                                          (vector-ref
                                                            (vector-ref
                                                              G86
                                                              1)
                                                            0)
                                                          (vector-ref
                                                            (vector-ref
                                                              G86
                                                              1)
                                                            2)
                                                          (vector-ref
                                                            G86
                                                            2))
                                                         ((lambda (v
                                                                   v1
                                                                   l1
                                                                   r1
                                                                   r)
                                                            (let ((G94
                                                                   (splay
                                                                     l1)))
                                                              (if (and (vector?
                                                                         G94)
                                                                       (equal?
                                                                         (vector-length
                                                                           G94)
                                                                         2))
                                                                  ((lambda (v2
                                                                            r2)
                                                                     (vector
                                                                       v2
                                                                       (node v1
                                                                             r2
                                                                             (node v
                                                                                   r1
                                                                                   r))))
                                                                   (vector-ref
                                                                     G94
                                                                     0)
                                                                   (vector-ref
                                                                     G94
                                                                     1))
                                                                  ((lambda (G97)
                                                                     (match:error
                                                                       G97
                                                                       '(match
                                                                          (splay
                                                                            l1)
                                                                          (#(v2
                                                                              r2)
                                                                            (vector
                                                                              v2
                                                                              (node v1
                                                                                    r2
                                                                                    (node v
                                                                                          r1
                                                                                          r)))))))
                                                                   G94))))
                                                          (vector-ref
                                                            G86
                                                            0)
                                                          (vector-ref
                                                            (vector-ref
                                                              G86
                                                              1)
                                                            0)
                                                          (vector-ref
                                                            (vector-ref
                                                              G86
                                                              1)
                                                            1)
                                                          (vector-ref
                                                            (vector-ref
                                                              G86
                                                              1)
                                                            2)
                                                          (vector-ref
                                                            G86
                                                            2)))
                                                     (G88 G86)))
                                             (G88 G86))))))
                             splay)))
                      (let ((join
                             (lambda (G100) ;pjt: g100 -> (g100)
                               (let ((G102
                                      (lambda (G103)
                                        (match:error
                                          G103
                                          '(match
                                             G100
                                             ((() ()) ())
                                             ((() t) t)
                                             ((t ()) t)
                                             ((t t1)
                                              (match-let
                                                ((#(v l)
                                                   (splay-to-max t)))
                                                (node v l t1))))))))
                                 (if (pair? G100)
                                     (if (null? (car G100))
                                         (if (pair? (cdr G100))
                                             (if (null? (cadr@1 G100))
                                                 (if (null? (cddr@1 G100))
                                                     ((lambda () ()))
                                                     (G102 G100))
                                                 (if (null? (cddr@1 G100))
                                                     ((lambda (t) t)
                                                      (cadr@1 G100))
                                                     (G102 G100)))
                                             (G102 G100))
                                         (if (pair? (cdr G100))
                                             (if (null? (cadr@1 G100))
                                                 (if (null? (cddr@1 G100))
                                                     ((lambda (t) t)
                                                      (car G100))
                                                     (G102 G100))
                                                 (if (null? (cddr@1 G100))
                                                     ((lambda (t t1)
                                                        (let ((G109
                                                               (splay-to-max
                                                                 t)))
                                                          (if (and (vector?
                                                                     G109)
                                                                   (equal?
                                                                     (vector-length
                                                                       G109)
                                                                     2))
                                                              ((lambda (v
                                                                        l)
                                                                 (node v
                                                                       l
                                                                       t1))
                                                               (vector-ref
                                                                 G109
                                                                 0)
                                                               (vector-ref
                                                                 G109
                                                                 1))
                                                              ((lambda (G112)
                                                                 (match:error
                                                                   G112
                                                                   '(match
                                                                      (splay-to-max
                                                                        t)
                                                                      (#(v
                                                                          l)
                                                                        (node v
                                                                              l
                                                                              t1)))))
                                                               G109))))
                                                      (car G100)
                                                      (cadr@1 G100))
                                                     (G102 G100)))
                                             (G102 G100)))
                                     (G102 G100))))))
                        (let ((split
                               (lambda (t x no yes)
                                 (if (and (vector? t)
                                          (equal? (vector-length t) 3))
                                     ((lambda (x1 l r)
                                        (if (= x x1)
                                            (yes l r)
                                            (if (< x x1)
                                                (no l (node x1 () r))
                                                (no (node x1 l ()) r))))
                                      (vector-ref t 0)
                                      (vector-ref t 1)
                                      (vector-ref t 2))
                                     ((lambda (G117)
                                        (match:error
                                          G117
                                          '(match
                                             t
                                             (#(x1 l r)
                                               (cond
                                                 ((= x x1) (yes l r))
                                                 ((< x x1)
                                                  (no l (node x1 () r)))
                                                 (else
                                                  (no (node x1 l ())
                                                      r)))))))
                                      t)))))
                          (let ((splay-and-split
                                 (lambda (t x no yes)
                                   (if (null? t)
                                       (no () ())
                                       (split (splay t x) x no yes)))))
                            (let ((splay-keep-all
                                   (lambda (t p?)
                                     (tree-fold
                                       t
                                       ()
                                       (lambda (v l r)
                                         (if (p? v)
                                             (node v l r)
                                             (join l r)))))))
                              (let ((splay-combine
                                     (lambda (base
                                              alone-left
                                              alone-right
                                              left
                                              both)
                                       (letrec ((combine
                                                 (lambda (G120)	;pjt: g120 -> (g120)
                                                   (let ((G122
                                                          (lambda (G123)
                                                            (match:error
                                                              G123
                                                              '(match
                                                                 G120
                                                                 ((() ())
                                                                  base)
                                                                 ((() t)
                                                                  (alone-right
                                                                    t))
                                                                 ((t ())
                                                                  (alone-left
                                                                    t))
                                                                 ((#(x
                                                                      l
                                                                      r)
                                                                    t)
                                                                  (let ((continue
                                                                         (lambda (c)
                                                                           (lambda (l1
                                                                                    r1)
                                                                             (c x
                                                                                (lambda ()
                                                                                  (combine
                                                                                    l
                                                                                    l1))
                                                                                (lambda ()
                                                                                  (combine
                                                                                    r
                                                                                    r1)))))))
                                                                    (splay-and-split
                                                                      t
                                                                      x
                                                                      (continue
                                                                        left)
                                                                      (continue
                                                                        both)))))))))
                                                     (if (pair? G120)
                                                         (if (null?
                                                               (car G120))
                                                             (if (pair?
                                                                   (cdr G120))
                                                                 (if (null?
                                                                       (cadr@1
                                                                         G120))
                                                                     (if (null?
                                                                           (cddr@1
                                                                             G120))
                                                                         ((lambda ()
                                                                            base))
                                                                         (G122 G120))
                                                                     (if (null?
                                                                           (cddr@1
                                                                             G120))
                                                                         ((lambda (t)
                                                                            (alone-right
                                                                              t))
                                                                          (cadr@1
                                                                            G120))
                                                                         (G122 G120)))
                                                                 (G122 G120))
                                                             (if (pair?
                                                                   (cdr G120))
                                                                 (if (null?
                                                                       (cadr@1
                                                                         G120))
                                                                     (if (null?
                                                                           (cddr@1
                                                                             G120))
                                                                         ((lambda (t)
                                                                            (alone-left
                                                                              t))
                                                                          (car G120))
                                                                         (G122 G120))
                                                                     (if (and (vector?
                                                                                (car G120))
                                                                              (equal?
                                                                                (vector-length
                                                                                  (car G120))
                                                                                3)
                                                                              (null?
                                                                                (cddr@1
                                                                                  G120)))
                                                                         ((lambda (x
                                                                                   l
                                                                                   r
                                                                                   t)
                                                                            (let ((continue
                                                                                   (lambda (c)
                                                                                     (lambda (l1
                                                                                              r1)
                                                                                       (c x
                                                                                          (lambda ()
                                                                                            (combine
                                                                                              l
                                                                                              l1))
                                                                                          (lambda ()
                                                                                            (combine
                                                                                              r
                                                                                              r1)))))))
                                                                              (splay-and-split
                                                                                t
                                                                                x
                                                                                (continue
                                                                                  left)
                                                                                (continue
                                                                                  both))))
                                                                          (vector-ref
                                                                            (car G120)
                                                                            0)
                                                                          (vector-ref
                                                                            (car G120)
                                                                            1)
                                                                          (vector-ref
                                                                            (car G120)
                                                                            2)
                                                                          (cadr@1
                                                                            G120))
                                                                         (G122 G120)))
                                                                 (G122 G120)))
                                                         (G122 G120))))))
                                         combine))))
                                      (let ((empty (lambda () (make-cell ()))))
                                        (let ((empty?
                                               (lambda (s)
                                                 (null? (cell-ref s)))))
                                          (let ((singleton
                                                 (lambda (x)
                                                   (make-cell (node x () ())))))
                                            (let ((size
                                                   (lambda (s)
                                                     (tree-size (cell-ref s)))))
                                              (let ((extremum
                                                     (lambda (splay-to
                                                              node)
                                                       (lambda (s)
                                                         (let ((t (cell-ref s)))
                                                           (if (null? t)
                                                               (error 'ordset-extremum
                                                                 "empty set")
                                                               (let ((G129
                                                                      (splay-to
                                                                        t)))
                                                                 (if (and (vector?
                                                                            G129)
                                                                          (equal?
                                                                            (vector-length
                                                                              G129)
                                                                            2))
                                                                     ((lambda (x
                                                                               lr)
                                                                        (begin (cell-set!
                                                                                 s
                                                                                 (node x
                                                                                       lr))
                                                                               x))
                                                                      (vector-ref
                                                                        G129
                                                                        0)
                                                                      (vector-ref
                                                                        G129
                                                                        1))
                                                                     ((lambda (G132)
                                                                        (match:error
                                                                          G132
                                                                          '(match
                                                                             (splay-to
                                                                               t)
                                                                             (#(x
                                                                                 lr)
                                                                               (cell-set!
                                                                                 s
                                                                                 (node x
                                                                                       lr))
                                                                               x))))
                                                                      G129)))))))))
                                                (let ((min@1
                                                       (extremum
                                                         splay-to-min
                                                         (lambda (x r)
                                                           (node x () r)))))
                                                  (let ((max@1
                                                         (extremum
                                                           splay-to-max
                                                           (lambda (x l)
                                                             (node x
                                                                   l
                                                                   ())))))
                                                    (let ((set-split
                                                           (lambda (s
                                                                    x
                                                                    no
                                                                    yes)
                                                             (let ((t
                                                                    (cell-ref s)))
                                                               (if (null?
                                                                     t)
                                                                   (no ()
                                                                       ())
                                                                   (let ((t
                                                                          (splay
                                                                            (cell-ref s)
                                                                            x)))
                                                                     (begin (cell-set!
                                                                              s
                                                                              t)
                                                                            (split
                                                                              t
                                                                              x
                                                                              no
                                                                              yes))))))))
                                                      (let ((contains?
                                                             (lambda (s x)
                                                               (set-split
                                                                 s
                                                                 x
                                                                 (lambda (_) ;pjt _ -> (_)
                                                                   #f)
                                                                 (lambda (_) ;pjt _ -> (_)
                                                                   #t)))))
                                                        (let ((add
                                                               (lambda (s
                                                                        x)
                                                                 (set-split
                                                                   s
                                                                   x
                                                                   (lambda (l
                                                                            r)
                                                                     (make-cell (node x
                                                                                l
                                                                                r)))
                                                                   (lambda (_) ;pjt: _ -> (_)
                                                                     s)))))
                                                          (let ((remove@1
                                                                 (lambda (s
                                                                          x)
                                                                   (set-split
                                                                     s
                                                                     x
                                                                     (lambda (_) ;pjt _ -> (_)
                                                                       s)
                                                                     (lambda (l
                                                                              r)
                                                                       (make-cell (if (null?
                                                                                  l)
                                                                                r
                                                                                (if (null?
                                                                                      r)
                                                                                    l
                                                                                    (let ((G135
                                                                                           (splay-to-max
                                                                                             l)))
                                                                                      (if (and (vector?
                                                                                                 G135)
                                                                                               (equal?
                                                                                                 (vector-length
                                                                                                   G135)
                                                                                                 2))
                                                                                          ((lambda (v
                                                                                                    l)
                                                                                             (begin (cell-set!
                                                                                                      s
                                                                                                      (node x
                                                                                                            (node v
                                                                                                                  l
                                                                                                                  ())
                                                                                                            r))
                                                                                                    (node v
                                                                                                          l
                                                                                                          r)))
                                                                                           (vector-ref
                                                                                             G135
                                                                                             0)
                                                                                           (vector-ref
                                                                                             G135
                                                                                             1))
                                                                                          ((lambda (G138)
                                                                                             (match:error
                                                                                               G138
                                                                                               '(match
                                                                                                  (splay-to-max
                                                                                                    l)
                                                                                                  (#(v
                                                                                                      l)
                                                                                                    (cell-set!
                                                                                                      s
                                                                                                      (node x
                                                                                                            (node v
                                                                                                                  l
                                                                                                                  ())
                                                                                                            r))
                                                                                                    (node v
                                                                                                          l
                                                                                                          r)))))
                                                                                           G135)))))))))))
                                                            (let ((subset
                                                                   (lambda (s
                                                                            p?)
                                                                     (make-cell (splay-keep-all
                                                                            (cell-ref s)
                                                                            p?)))))
                                                              (let ((set-combine
                                                                     (lambda (base
                                                                              alone
                                                                              no
                                                                              yes
                                                                              top)
                                                                       (lambda (left
                                                                                both
                                                                                right)
                                                                         (let ((node
                                                                                (lambda (b)
                                                                                  (if b
                                                                                      yes
                                                                                      no))))
                                                                           (let ((combine
                                                                                  (splay-combine
                                                                                    base
                                                                                    (alone
                                                                                      left)
                                                                                    (alone
                                                                                      right)
                                                                                    (node left)
                                                                                    (node both))))
                                                                             (lambda (s
                                                                                      s1)
                                                                               (top (combine
                                                                                      (cell-ref s)
                                                                                      (cell-ref s1))))))))))
                                                                (let ((combine-bool
                                                                       (set-combine
                                                                         #t
                                                                         (lambda (b)
                                                                           (lambda (_)
                                                                             b))
                                                                         (lambda (_)
                                                                           #f)
                                                                         (lambda (_
                                                                                  l
                                                                                  r)
                                                                           (and (l)
                                                                                (r)))
                                                                         (lambda (b)
                                                                           b))))
                                                                  (let ((subset?
                                                                         (combine-bool
                                                                           #f
                                                                           #t
                                                                           #t)))
                                                                    (let ((superset?
                                                                           (combine-bool
                                                                             #t
                                                                             #t
                                                                             #f)))
                                                                      (let ((disjoint?
                                                                             (combine-bool
                                                                               #t
                                                                               #f
                                                                               #t)))
                                                                        (let ((splay-equal?
                                                                               (combine-bool
                                                                                 #f
                                                                                 #t
                                                                                 #f)))
                                                                          (let ((combine-sets
                                                                                 (set-combine
                                                                                   ()
                                                                                   (lambda (b)
                                                                                     (if b
                                                                                         (lambda (t)
                                                                                           t)
                                                                                         (lambda (_)
                                                                                           ())))
                                                                                   (lambda (_
                                                                                            l
                                                                                            r)
                                                                                     (join (l)
                                                                                           (r)))
                                                                                   (lambda (x
                                                                                            l
                                                                                            r)
                                                                                     (node x
                                                                                           (l)
                                                                                           (r)))
                                                                                   (lambda (x) (make-cell x)))))
                                                                            (let ((union
                                                                                   (combine-sets
                                                                                     #t
                                                                                     #t
                                                                                     #t)))
                                                                              (let ((intersection
                                                                                     (combine-sets
                                                                                       #f
                                                                                       #t
                                                                                       #f)))
                                                                                (let ((difference
                                                                                       (combine-sets
                                                                                         #t
                                                                                         #f
                                                                                         #f)))
                                                                                  (let ((list->
                                                                                         (lambda (l)
                                                                                           (letrec ((loop
                                                                                                     (lambda (l
                                                                                                              s)
                                                                                                       (if (null?
                                                                                                             l)
                                                                                                           s
                                                                                                           (loop (cdr l)
                                                                                                                 (add s
                                                                                                                      (car l)))))))
                                                                                             (loop l
                                                                                                   (empty))))))
                                                                                    (let ((x->list
                                                                                           (lambda (s)
                                                                                             (tree->list
                                                                                               (cell-ref s)))))
                                                                                      (let ((exists?
                                                                                             (lambda (s
                                                                                                      p?)
                                                                                               (tree-exists?
                                                                                                 (cell-ref s)
                                                                                                 p?))))
                                                                                        (let ((forall?
                                                                                               (lambda (s
                                                                                                        p?)
                                                                                                 (tree-forall?
                                                                                                   (cell-ref s)
                                                                                                   p?))))
                                                                                          (let ((foreach
                                                                                                 (lambda (s
                                                                                                          f)
                                                                                                   (tree-foreach
                                                                                                     (cell-ref s)
                                                                                                     f))))
                                                                                            (letrec ((loop
                                                                                                      (lambda (i)
                                                                                                        (or (= i
                                                                                                               *numTest*)
                                                                                                            (let ((empty@1
                                                                                                                   (empty))
                                                                                                                  (odds
                                                                                                                   (list->
                                                                                                                     (list@1
                                                                                                                       1
                                                                                                                       3
                                                                                                                       5
                                                                                                                       7
                                                                                                                       9)))
                                                                                                                  (evens
                                                                                                                   (list->
                                                                                                                     (list@1
                                                                                                                       2
                                                                                                                       4
                                                                                                                       6
                                                                                                                       8
                                                                                                                       10)))
                                                                                                                  (mix
                                                                                                                   (list->
                                                                                                                     (list@1
                                                                                                                       1
                                                                                                                       2
                                                                                                                       4
                                                                                                                       7
                                                                                                                       8))))
                                                                                                              (begin (if (and (empty?
                                                                                                                                empty@1)
                                                                                                                              (not (empty?
                                                                                                                                     odds))
                                                                                                                              (= 0
                                                                                                                                 (size empty@1))
                                                                                                                              (= 5
                                                                                                                                 (size odds))
                                                                                                                              (splay-equal?
                                                                                                                                odds
                                                                                                                                odds)
                                                                                                                              (not (splay-equal?
                                                                                                                                     odds
                                                                                                                                     evens))
                                                                                                                              (= 10
                                                                                                                                 (max@1
                                                                                                                                   evens))
                                                                                                                              (= 1
                                                                                                                                 (min@1
                                                                                                                                   odds))
                                                                                                                              (contains?
                                                                                                                                odds
                                                                                                                                5)
                                                                                                                              (not (contains?
                                                                                                                                     odds
                                                                                                                                     6))
                                                                                                                              (subset?
                                                                                                                                odds
                                                                                                                                odds)
                                                                                                                              (not (subset?
                                                                                                                                     mix
                                                                                                                                     odds))
                                                                                                                              (subset?
                                                                                                                                mix
                                                                                                                                (union
                                                                                                                                  odds
                                                                                                                                  evens))
                                                                                                                              (superset?
                                                                                                                                (add odds
                                                                                                                                     11)
                                                                                                                                odds)
                                                                                                                              (superset?
                                                                                                                                odds
                                                                                                                                (difference
                                                                                                                                  mix
                                                                                                                                  evens))
                                                                                                                              (disjoint?
                                                                                                                                (difference
                                                                                                                                  mix
                                                                                                                                  odds)
                                                                                                                                odds)
                                                                                                                              (not (disjoint?
                                                                                                                                     evens
                                                                                                                                     evens))
                                                                                                                              (superset?
                                                                                                                                odds
                                                                                                                                (remove@1
                                                                                                                                  odds
                                                                                                                                  1))
                                                                                                                              (splay-equal?
                                                                                                                                odds
                                                                                                                                (remove@1
                                                                                                                                  odds
                                                                                                                                  2))
                                                                                                                              (forall?
                                                                                                                                odds
                                                                                                                                (lambda (x) (odd? x)))
                                                                                                                              (forall?
                                                                                                                                evens
                                                                                                                                (lambda (x) (even? x)))
                                                                                                                              (subset?
                                                                                                                                (subset
                                                                                                                                  mix
                                                                                                                                  (lambda (x) (even? x)))
                                                                                                                                evens)
                                                                                                                              (let ((sum
                                                                                                                                     0))
                                                                                                                                (begin (foreach
                                                                                                                                         odds
                                                                                                                                         (lambda (x)
                                                                                                                                           (set! sum
                                                                                                                                             (+ sum
                                                                                                                                                x))))
                                                                                                                                       (= sum
                                                                                                                                          25)))
                                                                                                                              (subset?
                                                                                                                                (intersection
                                                                                                                                  mix
                                                                                                                                  odds)
                                                                                                                                odds))
                                                                                                                         (void)
                                                                                                                         (error 'splay-test
                                                                                                                           ""))
                                                                                                                     (loop (+ i
                                                                                                                              1))))))))
                                                                                              (loop 0))))))))))))))))))))))))))))))))))))))))))))))
